{
  "version": 3,
  "sources": ["../index.js"],
  "sourcesContent": ["import { createLayerControl } from \"./map-layers.js\";\n\nexport class ICEPIGTracker {\n  constructor() {\n    this.translations = {};\n    this.currentLang = \"en\";\n    this.magicCode = this.generateMagicCode();\n    this.vectorSource = new ol.source.Vector();\n    this.markers = [];\n    this.stats = { ice: 0, pig: 0, total: 0, today: 0 };\n    this.displayedMarkerIds = new Set();\n    this.ws = null;\n    this.reconnectAttempts = 0;\n    this.maxReconnectAttempts = 5;\n    this.deferredPrompt = null;\n    // this.init(); // Initialization is now triggered in data-viz.js\n  }\n\n  generateMagicCode() {\n    return Math.random().toString(36).substring(2, 15);\n  }\n\n  async init() {\n    this.showLoadingIndicator();\n    try {\n      await this.loadTranslations();\n      this.setupEventListeners();\n      this.updateUIText();\n      this.setupMap();\n      await this.loadMarkers();\n      this.animateEntrance();\n      this.startAutoRefresh();\n      this.setupRefreshButton();\n      this.connectWebSocket();\n      this.setupInstallPrompt();\n    } catch (error) {\n      console.error(\"Init error:\", error);\n      this.showToast(\"Failed to load application\", \"error\");\n    } finally {\n      this.hideLoadingIndicator();\n    }\n  }\n\n  async loadTranslations() {\n    const response = await fetch(\"./pmaptranslate.json\");\n    this.translations = await response.json();\n  }\n\n  t(key) {\n    return this.translations[this.currentLang]?.[key] || key;\n  }\n\n  setupMap() {\n    const kcCenter = ol.proj.fromLonLat([-94.5786, 39.0997]);\n\n    try {\n      this.map = new ol.Map({\n        target: \"map\",\n        layers: [\n          new ol.layer.Tile({\n            source: new ol.source.OSM(),\n          }),\n          new ol.layer.Vector({\n            source: this.vectorSource,\n            style: this.getMarkerStyle.bind(this),\n          }),\n        ],\n        view: new ol.View({\n          center: kcCenter,\n          zoom: window.innerWidth < 768 ? 10 : 11,\n        }),\n      });\n\n      this.map.on(\"click\", this.onMapClick.bind(this));\n\n      // Force map resize on mobile\n      setTimeout(() => {\n        if (this.map) {\n          this.map.updateSize();\n        }\n      }, 100);\n      createLayerControl(this.map);\n    } catch (error) {\n      console.error(\"Map setup error:\", error);\n      document.getElementById(\"map\").innerHTML =\n        '<div style=\"display:flex;align-items:center;justify-content:center;height:100%;color:#666;\">Map failed to load. Please refresh.</div>';\n    }\n  }\n\n  getMarkerStyle(feature) {\n    const type = feature.get(\"type\");\n    const color = type === \"ICE\" ? \"#ff4444\" : \"#4444ff\";\n\n    return new ol.style.Style({\n      image: new ol.style.Icon({\n        anchor: [0.5, 1],\n        src: `data:image/svg+xml,${encodeURIComponent(`\n          <svg width=\"24\" height=\"36\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M12 0C5.4 0 0 5.4 0 12c0 9 12 24 12 24s12-15 12-24c0-6.6-5.4-12-12-12z\" fill=\"${color}\"/>\n            <circle cx=\"12\" cy=\"12\" r=\"6\" fill=\"white\"/>\n            <text x=\"12\" y=\"16\" text-anchor=\"middle\" font-size=\"8\" fill=\"${color}\">${type}</text>\n          </svg>\n        `)}`,\n      }),\n    });\n  }\n\n  setupEventListeners() {\n    document.getElementById(\"addBtn\").onclick = () => this.toggleAddMode();\n    document.getElementById(\"vizBtn\").onclick = () => this.toggleSidebar();\n    document.getElementById(\"closeSidebar\").onclick = () => this.closeSidebar();\n    document.getElementById(\"langSelect\").onchange = (e) =>\n      this.changeLang(e.target.value);\n    document.querySelector(\".close\").onclick = () => this.closeModal();\n    document\n      .getElementById(\"searchBtn\")\n      .addEventListener(\"click\", () => this.searchLocation());\n    document.getElementById(\"searchInput\").addEventListener(\"keypress\", (e) => {\n      if (e.key === \"Enter\") {\n        this.searchLocation();\n      }\n    });\n\n    // Keyboard shortcuts\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Escape\") this.closeModal();\n      if (e.key === \"d\" && e.ctrlKey) {\n        e.preventDefault();\n        this.toggleSidebar();\n      }\n    });\n  }\n\n  async onMapClick(evt) {\n    if (this.addMode) {\n      const coords = ol.proj.toLonLat(evt.coordinate);\n      this.showAddMarkerModal(coords);\n    } else {\n      const feature = this.map.forEachFeatureAtPixel(evt.pixel, (f) => f);\n      if (feature) {\n        this.showMarkerDetails(feature);\n      }\n    }\n  }\n\n  showAddMarkerModal(coords) {\n    document.getElementById(\"modal-body\").innerHTML = `\n      <h3 style=\"margin-top: 0; color: #2c3e50;\">${this.t(\n        \"add_new_marker\"\n      )}</h3>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Report Type</label>\n        <select id=\"markerType\" style=\"background: white;\">\n          <option value=\"ICE\">\uD83D\uDEA8 ICE Activity</option>\n          <option value=\"PIG\">\uD83D\uDC37 PIG Activity</option>\n        </select>\n      </div>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Title *</label>\n        <input id=\"markerTitle\" placeholder=\"Brief description of the incident\" required>\n      </div>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Details</label>\n        <textarea id=\"markerDesc\" placeholder=\"Additional details, time, description...\"></textarea>\n      </div>\n      <div style=\"margin-bottom: 20px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Media (Optional)</label>\n        <input id=\"mediaUpload\" type=\"file\" accept=\"image/*,video/*\" multiple>\n        <small style=\"color: #666; font-size: 12px;\">Images and videos are uploaded anonymously</small>\n      </div>\n      <div style=\"display: flex; gap: 10px; justify-content: flex-end;\">\n        <button onclick=\"tracker.closeModal()\" style=\"background: #95a5a6;\">${this.t(\n          \"cancel\"\n        )}</button>\n        <button onclick=\"tracker.saveMarker([${coords}])\" class=\"primary-btn\">${this.t(\n      \"save\"\n    )}</button>\n      </div>\n    `;\n\n    const modal = document.getElementById(\"modal\");\n    modal.style.display = \"block\";\n\n    gsap.from(\".modal-content\", {\n      scale: 0.8,\n      opacity: 0,\n      duration: 0.3,\n      ease: \"back.out(1.7)\",\n    });\n  }\n\n  async saveMarker(coords) {\n    const type = document.getElementById(\"markerType\").value;\n    const title = document.getElementById(\"markerTitle\").value;\n    const desc = document.getElementById(\"markerDesc\").value;\n    const files = document.getElementById(\"mediaUpload\").files;\n\n    if (!title) {\n      this.showToast(\"Please enter a title\", \"error\");\n      return;\n    }\n\n    const marker = {\n      id: Date.now().toString(),\n      type,\n      title,\n      description: desc,\n      coords,\n      timestamp: new Date().toISOString(),\n      magicCode: this.magicCode,\n      media: [],\n    };\n\n    const saveBtn = document.querySelector(\".modal-content .primary-btn\");\n    const originalText = saveBtn.textContent;\n    saveBtn.textContent = \"Saving...\";\n    saveBtn.disabled = true;\n\n    try {\n      let successfulUploads = [];\n      let failedUploads = 0;\n\n      if (files.length > 0) {\n        saveBtn.textContent = `Uploading ${files.length} file(s)...`;\n\n        const uploadPromises = Array.from(files).map((file) =>\n          this.uploadMedia(file, marker.id)\n        );\n        const results = await Promise.allSettled(uploadPromises);\n\n        results.forEach((result) => {\n          if (result.status === \"fulfilled\" && result.value) {\n            successfulUploads.push(result.value);\n          } else {\n            failedUploads++;\n          }\n        });\n\n        marker.media = successfulUploads;\n      }\n\n      saveBtn.textContent = \"Saving report...\";\n      await this.saveToCloudflare(marker);\n\n      this.markers.push(marker);\n      this.addMarkerToMap(marker);\n      this.updateStats();\n      this.updateCharts();\n      this.closeModal();\n      this.addMode = false;\n\n      let successMessage = \"Report saved successfully!\";\n      if (failedUploads > 0) {\n        successMessage += ` (${failedUploads} media file(s) failed to upload.)`;\n        this.showToast(successMessage, \"error\"); // Show as a warning/error\n      } else {\n        this.showToast(successMessage, \"success\");\n      }\n    } catch (error) {\n      console.error(\"Save marker critical error:\", error);\n      this.showToast(\"Failed to save the report. Please try again.\", \"error\");\n    } finally {\n      saveBtn.textContent = originalText;\n      saveBtn.disabled = false;\n    }\n  }\n\n  async uploadMedia(file, markerId) {\n    try {\n      const response = await fetch(\"/api/upload-url\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          filename: file.name,\n          contentType: file.type,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Upload URL request failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n      if (data.error) {\n        throw new Error(data.error);\n      }\n\n      const uploadResponse = await fetch(data.uploadUrl, {\n        method: \"PUT\",\n        body: file,\n        headers: { \"Content-Type\": file.type },\n      });\n\n      if (!uploadResponse.ok) {\n        throw new Error(`Upload failed: ${uploadResponse.status}`);\n      }\n\n      return data.publicUrl || data.uploadUrl.split(\"?\")[0];\n    } catch (error) {\n      console.error(\"Upload failed:\", error);\n      this.showToast(`Upload failed: ${error.message}`, \"error\");\n      return null;\n    }\n  }\n\n  async saveToCloudflare(marker) {\n    let retries = 3;\n    let delay = 1000;\n\n    while (retries > 0) {\n      const response = await fetch(\"/api/markers\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(marker),\n      });\n\n      if (response.ok) {\n        return response.json();\n      }\n\n      if (response.status === 429) {\n        console.warn(\"Rate limited. Retrying...\");\n        await new Promise((resolve) => setTimeout(resolve, delay));\n        delay *= 2; // Exponential backoff\n        retries--;\n      } else {\n        const error = await response\n          .json()\n          .catch(() => ({ error: \"Unknown error\" }));\n        throw new Error(error.error || \"Failed to save marker\");\n      }\n    }\n\n    throw new Error(\"Rate limit exceeded. Try again later.\");\n  }\n\n  addMarkerToMap(marker) {\n    if (this.displayedMarkerIds.has(marker.id)) {\n      console.log(`Marker ${marker.id} already displayed, skipping`);\n      return null;\n    }\n\n    let lng = ((marker.coords[1] + 180) % 360) - 180;\n\n    if (isNaN(marker.coords[0]) || isNaN(lng)) {\n      console.error(\"Invalid coordinates for marker:\", marker);\n      return null;\n    }\n\n    const color = this.getMarkerColor(marker);\n    const style = this.createMarkerStyle(color);\n\n    const feature = new ol.Feature({\n      geometry: new ol.geom.Point(ol.proj.fromLonLat([lng, marker.coords[0]])),\n      ...marker,\n    });\n\n    feature.setStyle(style);\n    this.vectorSource.addFeature(feature);\n    this.displayedMarkerIds.add(marker.id);\n\n    // Add pulse animation for new markers\n    setTimeout(() => {\n      const pixel = this.map.getPixelFromCoordinate(\n        ol.proj.fromLonLat([lng, marker.coords[0]])\n      );\n      if (pixel) {\n        this.animateMarkerPulse(pixel);\n      }\n    }, 100);\n\n    return feature;\n  }\n\n  animateMarkerPulse(pixel) {\n    const pulseEl = document.createElement(\"div\");\n    pulseEl.className = \"marker-pulse\";\n    pulseEl.style.left = pixel[0] + \"px\";\n    pulseEl.style.top = pixel[1] + \"px\";\n    document.body.appendChild(pulseEl);\n\n    setTimeout(() => pulseEl.remove(), 2000);\n  }\n\n  getMarkerColor(marker) {\n    const baseColor = marker.type === \"ICE\" ? \"red\" : \"blue\";\n    const age = Date.now() - new Date(marker.timestamp).getTime();\n    const dayInMs = 24 * 60 * 60 * 1000;\n\n    if (age < dayInMs) return `${baseColor}-bright`;\n    if (age < 7 * dayInMs) return baseColor;\n    return `${baseColor}-faded`;\n  }\n\n  createMarkerStyle(color) {\n    const colors = {\n      \"red-bright\": \"#ff0000\",\n      red: \"#cc0000\",\n      \"red-faded\": \"#880000\",\n      \"blue-bright\": \"#0000ff\",\n      blue: \"#0000cc\",\n      \"blue-faded\": \"#000088\",\n    };\n\n    return new ol.style.Style({\n      image: new ol.style.Circle({\n        radius: 8,\n        fill: new ol.style.Fill({ color: colors[color] || \"#ff0000\" }),\n        stroke: new ol.style.Stroke({ color: \"#fff\", width: 2 }),\n      }),\n    });\n  }\n\n  async refreshMarkers() {\n    try {\n      const response = await fetch(\"/api/markers\");\n      const markers = await response.json();\n\n      let newCount = 0;\n      markers.forEach((marker) => {\n        if (!this.displayedMarkerIds.has(marker.id)) {\n          this.addMarkerToMap(marker);\n          newCount++;\n        }\n      });\n\n      if (newCount > 0) {\n        this.showToast(`Added ${newCount} new marker(s)`, \"success\");\n      } else {\n        this.showToast(\"Map is up to date\", \"success\");\n      }\n    } catch (error) {\n      console.error(\"Refresh error:\", error);\n      this.showToast(\"Failed to refresh markers\", \"error\");\n    }\n  }\n\n  startAutoRefresh() {\n    setInterval(() => this.refreshMarkers(), 60000);\n  }\n\n  setupRefreshButton() {\n    const refreshBtn = document.createElement(\"button\");\n    refreshBtn.id = \"refresh-btn\";\n    refreshBtn.className = \"secondary-btn\";\n    refreshBtn.innerHTML = \"\u21BB\";\n    refreshBtn.title = \"Refresh Map\";\n    refreshBtn.addEventListener(\"click\", () => {\n      refreshBtn.innerHTML = \"...\";\n      this.refreshMarkers().finally(() => {\n        refreshBtn.innerHTML = \"\u21BB\";\n      });\n    });\n\n    document.querySelector(\".controls\").appendChild(refreshBtn);\n  }\n\n  async loadMarkers() {\n    try {\n      const response = await fetch(\"/api/markers\");\n      const markers = await response.json();\n      this.markers = markers;\n      this.updateStats();\n      markers.forEach((marker) => this.addMarkerToMap(marker));\n      this.updateCharts();\n    } catch (error) {\n      console.error(\"Failed to load markers:\", error);\n    }\n  }\n\n  showMarkerDetails(feature) {\n    const data = feature.getProperties();\n    const mediaHtml =\n      data.media && data.media.length > 0\n        ? data.media\n            .map(\n              (url) =>\n                `<img src=\"${url}\" class=\"media-preview\" onerror=\"this.style.display='none'\">`\n            )\n            .join(\"\")\n        : \"\";\n\n    // Check session storage for upvote/report status\n    const upvoteKey = `upvoted_${data.id}`;\n    const reportKey = `reported_${data.id}`;\n    const alreadyUpvoted = sessionStorage.getItem(upvoteKey);\n    const alreadyReported = sessionStorage.getItem(reportKey);\n\n    document.getElementById(\"modal-body\").innerHTML = `\n  <h3>${data.title}</h3>\n  <div class=\"modal-meta\">\n    <span><strong>Type:</strong> ${data.type}</span>\n    <span><strong>Posted:</strong> ${new Date(\n      data.timestamp\n    ).toLocaleString()}</span>\n  </div>\n  <p>${data.description || \"No description\"}</p>\n  ${mediaHtml}\n  \n  <div class=\"modal-actions\">\n    <button id=\"report-btn\" onclick=\"tracker.reportMarker('${data.id}')\" ${\n      alreadyReported ? \"disabled\" : \"\"\n    }>\n      ${alreadyReported ? \"\u2713 Reported\" : \"\u26A0 Report\"}\n    </button>\n    <button id=\"upvote-btn\" onclick=\"tracker.upvoteMarker('${data.id}')\" ${\n      alreadyUpvoted ? \"disabled\" : \"\"\n    }>\n      \uD83D\uDC4D ${\n        alreadyUpvoted ? this.t(\"upvoted\") : this.t(\"upvote\")\n      } (<span id=\"upvote-count\">${data.upvotes || 0}</span>)\n    </button>\n  </div>\n\n  <div id=\"comments\"><h4>${this.t(\"comments\")}</h4></div>\n  <textarea id=\"newComment\" placeholder=\"${this.t(\"add_comment\")}\"></textarea>\n  <input id=\"commentAuthor\" placeholder=\"${this.t(\"author\")}\">\n  <button onclick=\"tracker.addComment('${data.id}')\">${this.t(\n      \"add_comment\"\n    )}</button>\n  \n  ${\n    this.canEdit(data)\n      ? `\n    <div class=\"admin-actions\">\n      <button onclick=\"tracker.deleteMarker('${data.id}')\">${this.t(\n          \"delete\"\n        )}</button>\n    </div>\n  `\n      : \"\"\n  }\n`;\n    this.loadComments(data.id);\n    document.getElementById(\"modal\").style.display = \"block\";\n  }\n\n  async upvoteMarker(markerId) {\n    const upvoteBtn = document.getElementById(\"upvote-btn\");\n    if (!upvoteBtn || upvoteBtn.disabled) return;\n\n    try {\n      const response = await fetch(`/api/upvotes/${markerId}`, {\n        method: \"POST\",\n      });\n      if (!response.ok) {\n        const err = await response.json();\n        throw new Error(err.error || \"Upvote failed\");\n      }\n\n      const data = await response.json();\n      sessionStorage.setItem(`upvoted_${markerId}`, \"true\");\n\n      upvoteBtn.disabled = true;\n      upvoteBtn.innerHTML = `\uD83D\uDC4D ${this.t(\"upvoted\")} (<span id=\"upvote-count\">${\n        data.upvotes\n      }</span>)`;\n\n      this.showToast(\"Upvoted!\", \"success\");\n    } catch (error) {\n      console.error(\"Upvote error:\", error);\n      this.showToast(error.message, \"error\");\n    }\n  }\n\n  async reportMarker(markerId) {\n    if (\n      !confirm(\n        this.t(\"confirm_report\") || \"Are you sure you want to report this?\"\n      )\n    ) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/markers/${markerId}/report`, {\n        method: \"POST\",\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Report failed\");\n      }\n\n      sessionStorage.setItem(`reported_${markerId}`, \"true\");\n\n      const reportBtn = document.getElementById(\"report-btn\");\n      if (reportBtn) {\n        reportBtn.disabled = true;\n        reportBtn.textContent = \"\u2713 Reported\";\n      }\n\n      this.showToast(\"Report submitted. Thank you.\", \"success\");\n    } catch (error) {\n      console.error(\"Report error:\", error);\n      this.showToast(\"Failed to submit report\", \"error\");\n    }\n  }\n\n  connectWebSocket() {\n    try {\n      const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n      const wsUrl = `${protocol}//${window.location.host}/ws`;\n\n      this.ws = new WebSocket(wsUrl, [], { timeout: 5000 });\n\n      this.ws.onopen = () => {\n        console.log(\"WebSocket connected\");\n        this.reconnectAttempts = 0;\n        this.showToast(\"Connected to live updates\", \"success\");\n      };\n\n      this.ws.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n        this.handleWebSocketMessage(data);\n      };\n\n      this.ws.onerror = (error) => {\n        console.error(\"WebSocket error:\", error);\n      };\n\n      this.ws.onclose = () => {\n        console.log(\"WebSocket disconnected\");\n        this.reconnectWebSocket();\n      };\n    } catch (error) {\n      console.error(\"Failed to establish WebSocket:\", error);\n    }\n  }\n\n  reconnectWebSocket() {\n    if (this.reconnectAttempts < this.maxReconnectAttempts) {\n      const delay = Math.min(1000 * Math.pow(2, this.reconnectAttempts), 30000);\n      this.reconnectAttempts++;\n\n      console.log(\n        `Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts})`\n      );\n      setTimeout(() => this.connectWebSocket(), delay);\n    } else {\n      this.showToast(\n        \"Live updates disconnected. Refresh page to reconnect.\",\n        \"error\"\n      );\n    }\n  }\n\n  handleWebSocketMessage(data) {\n    console.log(\"WebSocket message:\", data);\n\n    switch (data.type) {\n      case \"welcome\":\n        console.log(`Connected. ${data.activeUsers} active users`);\n        this.updateActiveUsers(data.activeUsers);\n        break;\n\n      case \"marker_added\":\n        if (!this.displayedMarkerIds.has(data.marker.id)) {\n          this.addMarkerToMap(data.marker);\n          this.showToast(\"New report added\", \"info\");\n          this.triggerHaptic(20);\n        }\n        break;\n\n      case \"active_users\":\n        this.updateActiveUsers(data.count);\n        break;\n\n      default:\n        console.log(\"Unknown message type:\", data.type);\n    }\n  }\n\n  updateActiveUsers(count) {\n    let userIndicator = document.getElementById(\"active-users\");\n    if (!userIndicator) {\n      userIndicator = document.createElement(\"div\");\n      userIndicator.id = \"active-users\";\n      userIndicator.className = \"active-users-indicator\";\n      document.querySelector(\".controls\").appendChild(userIndicator);\n    }\n    userIndicator.textContent = `\uD83D\uDC65 ${count} online`;\n  }\n\n  sendUserLocation() {\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n      const center = this.map.getView().getCenter();\n      const lonLat = ol.proj.toLonLat(center);\n\n      this.ws.send(\n        JSON.stringify({\n          type: \"user_location\",\n          location: {\n            lat: lonLat[1],\n            lng: lonLat[0],\n          },\n        })\n      );\n    }\n  }\n\n  canEdit(marker) {\n    return (\n      marker.magicCode === this.magicCode ||\n      localStorage.getItem(`edit_${marker.id}`) === \"true\"\n    );\n  }\n\n  async addComment(markerId) {\n    const text = document.getElementById(\"newComment\").value;\n    const author = document.getElementById(\"commentAuthor\").value;\n\n    if (!text) return;\n\n    const comment = {\n      markerId,\n      text,\n      author: author || \"Anonymous\",\n    };\n\n    try {\n      const response = await fetch(\"/api/comments\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(comment),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to save comment\");\n      }\n\n      this.loadComments(markerId);\n      this.showToast(\"Comment added\");\n      document.getElementById(\"newComment\").value = \"\";\n      document.getElementById(\"commentAuthor\").value = \"\";\n    } catch (error) {\n      console.error(\"Comment error:\", error);\n      this.showToast(\"Failed to add comment\", \"error\");\n    }\n  }\n\n  async loadComments(markerId) {\n    try {\n      const response = await fetch(`/api/comments/${markerId}`);\n      const comments = await response.json();\n\n      document.getElementById(\"comments\").innerHTML = comments\n        .map(\n          (c) => `\n        <div class=\"comment\">\n          <div class=\"comment-author\">${c.author}</div>\n          <div class=\"comment-time\">${new Date(\n            c.timestamp\n          ).toLocaleString()}</div>\n          <p>${c.text}</p>\n        </div>\n      `\n        )\n        .join(\"\");\n    } catch (error) {\n      console.error(\"Failed to load comments:\", error);\n    }\n  }\n\n  toggleAddMode() {\n    this.addMode = !this.addMode;\n    const btn = document.getElementById(\"addBtn\");\n\n    if (this.addMode) {\n      btn.innerHTML = `<span class=\"btn-icon\">\u2715</span> Done`;\n      btn.style.background = \"linear-gradient(45deg, #95a5a6, #7f8c8d)\";\n      this.showToast(\n        this.t(\"add_marker_instruction\") || \"Click on the map to add a report\"\n      );\n    } else {\n      btn.innerHTML = `<span class=\"btn-icon\">+</span> ${this.t(\n        \"add_new_marker\"\n      )}`;\n      btn.style.background = \"linear-gradient(45deg, #ff6b6b, #ee5a52)\";\n    }\n\n    gsap.to(btn, { scale: 1.05, duration: 0.1, yoyo: true, repeat: 1 });\n  }\n\n  changeLang(lang) {\n    this.currentLang = lang;\n    // Don't reinitialize everything, just update UI text\n    this.updateUIText();\n  }\n\n  closeModal() {\n    document.getElementById(\"modal\").style.display = \"none\";\n  }\n\n  triggerHaptic(pattern = 20) {\n    if (\"vibrate\" in navigator) {\n      navigator.vibrate(pattern);\n    }\n  }\n\n  playSound(type) {\n    try {\n      const audioContext = new (window.AudioContext ||\n        window.webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n\n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n\n      if (type === \"success\") {\n        oscillator.frequency.value = 800;\n        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(\n          0.01,\n          audioContext.currentTime + 0.1\n        );\n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.1);\n      } else if (type === \"error\") {\n        oscillator.frequency.value = 300;\n        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(\n          0.01,\n          audioContext.currentTime + 0.2\n        );\n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.2);\n      }\n    } catch (error) {\n      console.log(\"Audio not supported\");\n    }\n  }\n\n  showToast(message, type = \"info\") {\n    const toastContainer = document.getElementById(\"toast-container\");\n    const toast = document.createElement(\"div\");\n    toast.className = `toast toast-${type}`;\n    toast.textContent = message;\n    toastContainer.appendChild(toast);\n\n    setTimeout(() => {\n      toast.style.opacity = \"1\";\n      toast.style.transform = \"translateX(0)\";\n    }, 10);\n\n    setTimeout(() => {\n      toast.style.opacity = \"0\";\n      toast.style.transform = \"translateX(100%)\";\n      setTimeout(() => toast.remove(), 500);\n    }, 3000);\n\n    if (type === \"success\") {\n      this.triggerHaptic(20);\n      this.playSound(\"success\");\n    } else if (type === \"error\") {\n      this.triggerHaptic([50, 50, 50]);\n      this.playSound(\"error\");\n    }\n  }\n\n  async deleteMarker(id) {\n    if (!confirm(this.t(\"confirm_delete\"))) return;\n\n    try {\n      const response = await fetch(`/api/markers/${id}`, { method: \"DELETE\" });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to delete marker\");\n      }\n\n      const feature = this.vectorSource\n        .getFeatures()\n        .find((f) => f.get(\"id\") === id);\n      if (feature) this.vectorSource.removeFeature(feature);\n\n      this.markers = this.markers.filter((m) => m.id !== id);\n      this.updateStats();\n      this.updateCharts();\n      this.showToast(\"Report deleted\");\n      this.closeModal();\n    } catch (error) {\n      console.error(\"Delete error:\", error);\n      this.showToast(\"Failed to delete report\", \"error\");\n    }\n  }\n\n  setupInstallPrompt() {\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      this.deferredPrompt = e;\n      this.showInstallButton();\n    });\n\n    window.addEventListener(\"appinstalled\", () => {\n      console.log(\"PWA installed\");\n      this.deferredPrompt = null;\n      this.hideInstallButton();\n      this.showToast(\"App installed! Open from your home screen.\", \"success\");\n    });\n  }\n\n  showInstallButton() {\n    const installBtn = document.createElement(\"button\");\n    installBtn.id = \"install-btn\";\n    installBtn.className = \"secondary-btn\";\n    installBtn.innerHTML = \"\uD83D\uDCF1 Install App\";\n    installBtn.addEventListener(\"click\", () => this.promptInstall());\n\n    document.querySelector(\".controls\").appendChild(installBtn);\n  }\n\n  hideInstallButton() {\n    const installBtn = document.getElementById(\"install-btn\");\n    if (installBtn) {\n      installBtn.remove();\n    }\n  }\n\n  async promptInstall() {\n    if (!this.deferredPrompt) return;\n\n    this.deferredPrompt.prompt();\n    const { outcome } = await this.deferredPrompt.userChoice;\n\n    console.log(`Install prompt outcome: ${outcome}`);\n    this.deferredPrompt = null;\n    this.hideInstallButton();\n  }\n\n  async searchLocation() {\n    const query = document.getElementById(\"searchInput\").value;\n    if (!query) {\n      this.showToast(\"Please enter a location to search.\", \"error\");\n      return;\n    }\n\n    this.showToast(`Searching for \"${query}\"...`, \"info\");\n    try {\n      const response = await fetch(\n        `/api/search?q=${encodeURIComponent(query)}`\n      );\n      if (!response.ok) {\n        throw new Error(\"Network response was not ok.\");\n      }\n      const results = await response.json();\n\n      if (results.length > 0) {\n        const { lat, lon } = results[0];\n        this.showToast(`Location found. Moving map...`, \"success\");\n        this.panToLocation([parseFloat(lon), parseFloat(lat)]);\n      } else {\n        this.showToast(`Could not find \"${query}\".`, \"error\");\n      }\n    } catch (error) {\n      console.error(\"Nominatim search error:\", error);\n      this.showToast(\"Failed to perform search.\", \"error\");\n    }\n  }\n\n  panToLocation(lonLat) {\n    if (!this.map) return;\n\n    this.map.getView().animate({\n      center: ol.proj.fromLonLat(lonLat),\n      zoom: 14,\n      duration: 1500,\n      easing: ol.easing.easeOut,\n    });\n  }\n}\n\nICEPIGTracker.prototype.showLoadingIndicator = function () {\n  const indicator = document.getElementById(\"loading-indicator\");\n  if (indicator) indicator.style.display = \"flex\";\n};\n\nICEPIGTracker.prototype.hideLoadingIndicator = function () {\n  const indicator = document.getElementById(\"loading-indicator\");\n  if (indicator) {\n    indicator.remove();\n  }\n};\n\nICEPIGTracker.prototype.updateUIText = function () {\n  document.querySelectorAll(\"[data-translate-key]\").forEach((el) => {\n    const key = el.dataset.translateKey;\n    const translation = this.t(key);\n\n    // Handle the main add/cancel button state\n    if (el.id === \"addBtn\") {\n      const currentKey = this.addMode ? \"cancel\" : \"add_new_marker\";\n      const currentTranslation = this.t(currentKey);\n      el.dataset.translateKey = currentKey; // Update the key\n\n      // Find and update only the text node, preserving the icon span\n      for (const node of el.childNodes) {\n        if (\n          node.nodeType === Node.TEXT_NODE &&\n          node.textContent.trim().length > 0\n        ) {\n          node.textContent = ` ${currentTranslation}`;\n          break;\n        }\n      }\n      return; // Skip to next element\n    }\n\n    // Handle other buttons with icons\n    if (el.tagName === \"BUTTON\" && el.querySelector(\".btn-icon\")) {\n      for (const node of el.childNodes) {\n        if (\n          node.nodeType === Node.TEXT_NODE &&\n          node.textContent.trim().length > 0\n        ) {\n          node.textContent = ` ${translation}`;\n          break;\n        }\n      }\n    }\n    // Handle all other elements\n    else {\n      el.textContent = translation;\n    }\n  });\n};\n\n// The tracker is initialized in data-viz.js to ensure all scripts are loaded.\n"],
  "mappings": "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",
  "names": ["ICEPIGTracker", "error", "response", "key", "kcCenter", "createLayerControl", "feature", "type", "color", "evt", "coords", "f", "modal", "title", "desc", "files", "marker", "saveBtn", "originalText", "successfulUploads", "failedUploads", "uploadPromises", "file", "result", "successMessage", "markerId", "data", "uploadResponse", "retries", "delay", "resolve", "lng", "style", "pixel", "pulseEl", "baseColor", "age", "dayInMs", "colors", "markers", "newCount", "refreshBtn", "mediaHtml", "url", "upvoteKey", "reportKey", "alreadyUpvoted", "alreadyReported", "upvoteBtn", "err", "reportBtn", "wsUrl", "event", "count", "userIndicator", "center", "lonLat", "text", "author", "comment", "comments", "c", "btn", "lang", "pattern", "audioContext", "oscillator", "gainNode", "message", "toastContainer", "toast", "id", "m", "installBtn", "outcome", "query", "results", "lat", "lon", "indicator", "el", "translation", "currentKey", "currentTranslation", "node"]
}
