{
  "version": 3,
  "sources": ["../categories.js", "../index.js"],
  "sourcesContent": ["export const categories = {\n  ICE: {\n    label: \"ICE Activity\",\n    description: \"Sightings or activity of Immigration and Customs Enforcement.\",\n    color: \"#ff4444\",\n    icon: \"ti-building-factory-2\",\n    emoji: \"\uD83D\uDEA8\",\n    unicode: \"\uEC2E\",\n  },\n  PIG: {\n    label: \"PIG Activity\",\n    description: \"General police activity or presence.\",\n    color: \"#4444ff\",\n    icon: \"ti-bell-ringing-2\",\n    emoji: \"\uD83D\uDC37\",\n    unicode: \"\uEC18\",\n  },\n  CHECKPOINT: {\n    label: \"Checkpoint\",\n    description: \"DUI, license, or other types of police checkpoints.\",\n    color: \"#ff9800\",\n    icon: \"ti-traffic-cone\",\n    emoji: \"\uD83D\uDEA7\",\n    unicode: \"\uEF88\",\n  },\n  RAID: {\n    label: \"Raid\",\n    description: \"Confirmed raid on a home or workplace.\",\n    color: \"#9c27b0\",\n    icon: \"ti-door-off\",\n    emoji: \"\uD83D\uDEAA\",\n    unicode: \"\uEEBE\",\n  },\n  OTHER: {\n    label: \"Other\",\n    description: \"Other types of law enforcement activity.\",\n    color: \"#795548\",\n    icon: \"ti-question-mark\",\n    emoji: \"\u2753\",\n    unicode: \"\uEF05\",\n  },\n};", "import { createLayerControl } from \"./map-layers.js\";\nimport { categories } from \"./categories.js\";\n\nexport class ICEPIGTracker {\n  constructor() {\n    this.translations = {};\n    this.currentLang = \"en\";\n    this.magicCode = this.generateMagicCode();\n    this.vectorSource = new ol.source.Vector();\n    this.markers = [];\n    this.stats = { ice: 0, pig: 0, total: 0, today: 0 };\n    this.chartData = {\n      timeline: [],\n      types: { ice: 0, pig: 0 },\n      hourly: new Array(24).fill(0),\n      daily: new Array(7).fill(0),\n    };\n    this.displayedMarkerIds = new Set();\n    this.ws = null;\n    this.reconnectAttempts = 0;\n    this.maxReconnectAttempts = 5;\n    this.deferredPrompt = null;\n  }\n\n  generateMagicCode() {\n    return Math.random().toString(36).substring(2, 15);\n  }\n\n  async init() {\n    this.showLoadingIndicator();\n    try {\n      await this.loadTranslations();\n      this.setupEventListeners();\n      this.updateUIText();\n      this.setupMap();\n      this.setupLegend();\n      await this.loadMarkers();\n      // this.animateEntrance(); // This function is not defined\n      this.startAutoRefresh();\n      this.setupRefreshButton();\n      this.connectWebSocket();\n      this.setupInstallPrompt();\n    } catch (error) {\n      console.error(\"Init error:\", error);\n      this.showToast(\"Failed to load application\", \"error\");\n    } finally {\n      this.hideLoadingIndicator();\n    }\n  }\n\n  async loadTranslations() {\n    const response = await fetch(\"./pmaptranslate.json\");\n    this.translations = await response.json();\n  }\n\n  t(key) {\n    return this.translations[this.currentLang]?.[key] || key;\n  }\n\n  setupMap() {\n    const kcCenter = ol.proj.fromLonLat([-94.5786, 39.0997]);\n\n    try {\n      this.map = new ol.Map({\n        target: \"map\",\n        layers: [\n          new ol.layer.Tile({\n            source: new ol.source.OSM(),\n          }),\n          new ol.layer.Vector({\n            source: this.vectorSource,\n            style: this.getMarkerStyle.bind(this),\n          }),\n        ],\n        view: new ol.View({\n          center: kcCenter,\n          zoom: window.innerWidth < 768 ? 10 : 11,\n        }),\n      });\n\n      this.map.on(\"click\", this.onMapClick.bind(this));\n\n      // Force map resize on mobile\n      setTimeout(() => {\n        if (this.map) {\n          this.map.updateSize();\n        }\n      }, 100);\n      createLayerControl(this.map);\n    } catch (error) {\n      console.error(\"Map setup error:\", error);\n      document.getElementById(\"map\").innerHTML =\n        '<div style=\"display:flex;align-items:center;justify-content:center;height:100%;color:#666;\">Map failed to load. Please refresh.</div>';\n    }\n  }\n\n  setupLegend() {\n    const legendContainer = document.getElementById(\"legend-container\");\n    if (!legendContainer) return;\n\n    legendContainer.innerHTML = \"\"; // Clear existing legend\n\n    for (const key in categories) {\n      const category = categories[key];\n      const legendItem = document.createElement(\"div\");\n      legendItem.className = \"legend-item\";\n\n      const iconSvg = `\n        <svg width=\"20\" height=\"28\" viewBox=\"0 0 30 42\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin-right: 8px; vertical-align: middle;\">\n          <path d=\"M15 0 C8.373 0 3 5.373 3 12 C3 21.375 15 42 15 42 S27 21.375 27 12 C27 5.373 21.627 0 15 0 Z\" fill=\"${category.color}\"/>\n          <style>\n            .icon { font-family: \"tabler-icons\"; font-size: 18px; fill: white; }\n          </style>\n          <text x=\"15\" y=\"19\" class=\"icon\" text-anchor=\"middle\">${category.unicode}</text>\n        </svg>\n      `;\n\n      const label = document.createElement(\"span\");\n      label.textContent = category.label;\n\n      legendItem.innerHTML = iconSvg;\n      legendItem.appendChild(label);\n      legendContainer.appendChild(legendItem);\n    }\n  }\n\n  getMarkerStyle(feature) {\n    const type = feature.get(\"type\");\n    const category = categories[type] || categories.OTHER;\n    const color = category.color;\n    const iconUnicode = category.unicode;\n\n    return new ol.style.Style({\n      image: new ol.style.Icon({\n        anchor: [0.5, 1],\n        src: `data:image/svg+xml,${encodeURIComponent(`\n          <svg width=\"30\" height=\"42\" xmlns=\"http://www.w3.org/2000/svg\">\n            <defs>\n              <filter id=\"shadow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n                <feDropShadow dx=\"0\" dy=\"1\" stdDeviation=\"1\" flood-color=\"rgba(0,0,0,0.3)\"/>\n              </filter>\n            </defs>\n            <path d=\"M15 0 C8.373 0 3 5.373 3 12 C3 21.375 15 42 15 42 S27 21.375 27 12 C27 5.373 21.627 0 15 0 Z\" fill=\"${color}\" filter=\"url(#shadow)\"/>\n            <style>\n              .icon { font-family: \"tabler-icons\"; font-size: 18px; fill: white; }\n            </style>\n            <text x=\"15\" y=\"19\" class=\"icon\" text-anchor=\"middle\">${iconUnicode}</text>\n          </svg>\n        `)}`,\n      }),\n    });\n  }\n\n  setupEventListeners() {\n    document.getElementById(\"addBtn\").onclick = () => this.toggleAddMode();\n    document.getElementById(\"vizBtn\").onclick = () => this.toggleSidebar();\n    document.getElementById(\"closeSidebar\").onclick = () => this.closeSidebar();\n    document.getElementById(\"langSelect\").onchange = (e) =>\n      this.changeLang(e.target.value);\n    document.querySelector(\".close\").onclick = () => this.closeModal();\n\n    this.searchTimeout = null;\n    document.getElementById(\"searchInput\").addEventListener(\"keyup\", () => {\n      clearTimeout(this.searchTimeout);\n      this.searchTimeout = setTimeout(() => this.searchLocation(), 300);\n    });\n\n    // Hide search results when clicking outside\n    document.addEventListener(\"click\", (e) => {\n      const searchContainer = document.querySelector(\".search-container\");\n      if (searchContainer && !searchContainer.contains(e.target)) {\n        const searchResults = document.getElementById(\"searchResults\");\n        if (searchResults) {\n          searchResults.style.display = \"none\";\n        }\n      }\n    });\n\n    // Keyboard shortcuts\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Escape\") this.closeModal();\n      if (e.key === \"d\" && e.ctrlKey) {\n        e.preventDefault();\n        this.toggleSidebar();\n      }\n    });\n  }\n\n  async onMapClick(evt) {\n    if (this.addMode) {\n      const coords = ol.proj.toLonLat(evt.coordinate);\n      this.showAddMarkerModal(coords);\n    } else {\n      const feature = this.map.forEachFeatureAtPixel(evt.pixel, (f) => f);\n      if (feature) {\n        this.showMarkerDetails(feature);\n      }\n    }\n  }\n\n  showAddMarkerModal(coords) {\n    const categoryOptions = Object.entries(categories)\n      .map(\n        ([key, cat]) =>\n          `<option value=\"${key}\">${cat.emoji} ${cat.label}</option>`\n      )\n      .join(\"\");\n\n    document.getElementById(\"modal-body\").innerHTML = `\n      <h3 style=\"margin-top: 0; color: #2c3e50;\">${this.t(\n        \"add_new_marker\"\n      )}</h3>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Report Type</label>\n        <select id=\"markerType\" style=\"background: white;\">\n          ${categoryOptions}\n        </select>\n      </div>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Title *</label>\n        <input id=\"markerTitle\" placeholder=\"Brief description of the incident\" required>\n      </div>\n      <div style=\"margin-bottom: 15px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Details</label>\n        <textarea id=\"markerDesc\" placeholder=\"Additional details, time, description...\"></textarea>\n      </div>\n      <div style=\"margin-bottom: 20px;\">\n        <label style=\"display: block; margin-bottom: 5px; font-weight: 600; color: #555;\">Media (Optional)</label>\n        <input id=\"mediaUpload\" type=\"file\" accept=\"image/*,video/*\" multiple>\n        <small style=\"color: #666; font-size: 12px;\">Images and videos are uploaded anonymously</small>\n      </div>\n      <div style=\"display: flex; gap: 10px; justify-content: flex-end;\">\n        <button onclick=\"tracker.closeModal()\" style=\"background: #95a5a6;\">${this.t(\n          \"cancel\"\n        )}</button>\n        <button onclick=\"tracker.saveMarker([${coords}])\" class=\"primary-btn\">${this.t(\n      \"save\"\n    )}</button>\n      </div>\n    `;\n\n    const modal = document.getElementById(\"modal\");\n    modal.style.display = \"block\";\n\n    gsap.from(\".modal-content\", {\n      scale: 0.8,\n      opacity: 0,\n      duration: 0.3,\n      ease: \"back.out(1.7)\",\n    });\n  }\n\n  async saveMarker(coords) {\n    const type = document.getElementById(\"markerType\").value;\n    const title = document.getElementById(\"markerTitle\").value;\n    const desc = document.getElementById(\"markerDesc\").value;\n    const files = document.getElementById(\"mediaUpload\").files;\n\n    if (!title) {\n      this.showToast(\"Please enter a title\", \"error\");\n      return;\n    }\n\n    const marker = {\n      id: Date.now().toString(),\n      type,\n      title,\n      description: desc,\n      coords,\n      timestamp: new Date().toISOString(),\n      magicCode: this.magicCode,\n      media: [],\n    };\n\n    const saveBtn = document.querySelector(\".modal-content .primary-btn\");\n    const originalText = saveBtn.textContent;\n    saveBtn.textContent = \"Saving...\";\n    saveBtn.disabled = true;\n\n    const progressContainer = document.createElement('div');\n    progressContainer.className = 'progress-container';\n    const progressBar = document.createElement('div');\n    progressBar.className = 'progress-bar';\n    progressContainer.appendChild(progressBar);\n    saveBtn.parentElement.appendChild(progressContainer);\n\n    try {\n      let successfulUploads = [];\n      let failedUploads = 0;\n\n      if (files.length > 0) {\n        saveBtn.textContent = `Uploading ${files.length} file(s)...`;\n\n        const uploadPromises = Array.from(files).map((file, index) =>\n          this.uploadMedia(file, marker.id).then(url => {\n            progressBar.style.width = `${((index + 1) / files.length) * 100}%`;\n            return url;\n          })\n        );\n        const results = await Promise.allSettled(uploadPromises);\n\n        results.forEach((result) => {\n          if (result.status === \"fulfilled\" && result.value) {\n            successfulUploads.push(result.value);\n          } else {\n            failedUploads++;\n          }\n        });\n\n        marker.media = successfulUploads;\n      }\n\n      saveBtn.textContent = \"Saving report...\";\n      await this.saveToCloudflare(marker);\n\n      this.markers.push(marker);\n      this.addMarkerToMap(marker);\n      this.updateStats();\n      this.updateCharts();\n      this.closeModal();\n      this.addMode = false;\n\n      let successMessage = \"Report saved successfully!\";\n      if (failedUploads > 0) {\n        successMessage += ` (${failedUploads} media file(s) failed to upload.)`;\n        this.showToast(successMessage, \"error\"); // Show as a warning/error\n      } else {\n        this.showToast(successMessage, \"success\");\n      }\n    } catch (error) {\n      console.error(\"Save marker critical error:\", error);\n      this.showToast(\"Failed to save the report. Please try again.\", \"error\");\n    } finally {\n      saveBtn.textContent = originalText;\n      saveBtn.disabled = false;\n      progressContainer.remove();\n    }\n  }\n\n  async uploadMedia(file, markerId) {\n    try {\n      const response = await fetch(\"/api/upload-url\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          filename: file.name,\n          contentType: file.type,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Upload URL request failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n      if (data.error) {\n        throw new Error(data.error);\n      }\n\n      const uploadResponse = await fetch(data.uploadUrl, {\n        method: \"PUT\",\n        body: file,\n        headers: { \"Content-Type\": file.type },\n      });\n\n      if (!uploadResponse.ok) {\n        throw new Error(`Upload failed: ${uploadResponse.status}`);\n      }\n\n      return data.publicUrl;\n    } catch (error) {\n      console.error(\"Upload failed:\", error);\n      this.showToast(`Upload failed: ${error.message}`, \"error\");\n      return null;\n    }\n  }\n\n  async saveToCloudflare(marker) {\n    let retries = 3;\n    let delay = 1000;\n\n    while (retries > 0) {\n      const response = await fetch(\"/api/markers\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(marker),\n      });\n\n      if (response.ok) {\n        return response.json();\n      }\n\n      if (response.status === 429) {\n        console.warn(\"Rate limited. Retrying...\");\n        await new Promise((resolve) => setTimeout(resolve, delay));\n        delay *= 2; // Exponential backoff\n        retries--;\n      } else {\n        const error = await response\n          .json()\n          .catch(() => ({ error: \"Unknown error\" }));\n        throw new Error(error.error || \"Failed to save marker\");\n      }\n    }\n\n    throw new Error(\"Rate limit exceeded. Try again later.\");\n  }\n\n  addMarkerToMap(marker) {\n    if (this.displayedMarkerIds.has(marker.id)) {\n      console.log(`Marker ${marker.id} already displayed, skipping`);\n      return null;\n    }\n\n    if (!marker.coords && marker.lon && marker.lat) {\n      marker.coords = [marker.lon, marker.lat];\n    }\n\n    const lon = marker.coords[0];\n    const lat = marker.coords[1];\n\n    if (isNaN(lon) || isNaN(lat)) {\n      console.error(\"Invalid coordinates for marker:\", marker);\n      return null;\n    }\n\n    const feature = new ol.Feature({\n      geometry: new ol.geom.Point(ol.proj.fromLonLat([lon, lat])),\n      ...marker,\n    });\n\n    this.vectorSource.addFeature(feature);\n    this.displayedMarkerIds.add(marker.id);\n\n    // Add pulse animation for new markers\n    setTimeout(() => {\n      const pixel = this.map.getPixelFromCoordinate(\n        ol.proj.fromLonLat([lon, lat])\n      );\n      if (pixel) {\n        this.animateMarkerPulse(pixel);\n      }\n    }, 100);\n\n    return feature;\n  }\n\n  animateMarkerPulse(pixel) {\n    const pulseEl = document.createElement(\"div\");\n    pulseEl.className = \"marker-pulse\";\n    pulseEl.style.left = pixel[0] + \"px\";\n    pulseEl.style.top = pixel[1] + \"px\";\n    document.body.appendChild(pulseEl);\n\n    setTimeout(() => pulseEl.remove(), 2000);\n  }\n\n  async refreshMarkers() {\n    try {\n      const response = await fetch(\"/api/markers\");\n      const markers = await response.json();\n\n      let newCount = 0;\n      markers.forEach((marker) => {\n        if (!this.displayedMarkerIds.has(marker.id)) {\n          this.addMarkerToMap(marker);\n          newCount++;\n        }\n      });\n\n      if (newCount > 0) {\n        this.showToast(`Added ${newCount} new marker(s)`, \"success\");\n      } else {\n        this.showToast(\"Map is up to date\", \"success\");\n      }\n    } catch (error) {\n      console.error(\"Refresh error:\", error);\n      this.showToast(\"Failed to refresh markers\", \"error\");\n    }\n  }\n\n  startAutoRefresh() {\n    setInterval(() => this.refreshMarkers(), 60000);\n  }\n\n  setupRefreshButton() {\n    const refreshBtn = document.createElement(\"button\");\n    refreshBtn.id = \"refresh-btn\";\n    refreshBtn.className = \"secondary-btn\";\n    refreshBtn.innerHTML = \"\u21BB\";\n    refreshBtn.title = \"Refresh Map\";\n    refreshBtn.addEventListener(\"click\", () => {\n      refreshBtn.innerHTML = \"...\";\n      this.refreshMarkers().finally(() => {\n        refreshBtn.innerHTML = \"\u21BB\";\n      });\n    });\n\n    document.querySelector(\".secondary-controls\").appendChild(refreshBtn);\n  }\n\n  async loadMarkers() {\n    try {\n      const response = await fetch(\"/api/markers\");\n      const markers = await response.json();\n      this.markers = markers;\n      this.updateStats();\n      markers.forEach((marker) => this.addMarkerToMap(marker));\n      this.updateCharts();\n    } catch (error) {\n      console.error(\"Failed to load markers:\", error);\n    }\n  }\n\n  showMarkerDetails(feature) {\n    const data = feature.getProperties();\n    const mediaHtml = data.media && data.media.length > 0\n      ? data.media.map(url => {\n          const fileExtension = url.split('.').pop().toLowerCase();\n          if (['jpg', 'jpeg', 'png', 'gif', 'webp', 'avif', 'bmp', 'svg'].includes(fileExtension)) {\n            return `<img src=\"${url}\" class=\"media-preview\" onerror=\"this.style.display='none'\">`;\n          } else if (['mp4', 'webm', 'ogg', 'mov', 'avi'].includes(fileExtension)) {\n            return `<video controls class=\"media-preview\"><source src=\"${url}\" type=\"video/${fileExtension === 'mov' ? 'quicktime' : fileExtension}\"></video>`;\n          } else if (['mp3', 'wav', 'ogg', 'aac', 'm4a', 'flac'].includes(fileExtension)) {\n            return `<audio controls class=\"media-preview\"><source src=\"${url}\" type=\"audio/${fileExtension}\"></audio>`;\n          } else {\n            return `<a href=\"${url}\" target=\"_blank\">View Media</a>`;\n          }\n        }).join(\"\")\n      : \"\";\n\n    // Check session storage for upvote/report status\n    const upvoteKey = `upvoted_${data.id}`;\n    const reportKey = `reported_${data.id}`;\n    const alreadyUpvoted = sessionStorage.getItem(upvoteKey);\n    const alreadyReported = sessionStorage.getItem(reportKey);\n\n    document.getElementById(\"modal-body\").innerHTML = `\n  <h3>${data.title}</h3>\n  <div class=\"modal-meta\">\n    <span><strong>Type:</strong> ${data.type}</span>\n    <span><strong>Posted:</strong> ${new Date(\n      data.timestamp\n    ).toLocaleString()}</span>\n  </div>\n  <p>${data.description || \"No description\"}</p>\n  <div class=\"media-container\">${mediaHtml}</div>\n  \n  <div class=\"modal-actions\">\n    <button id=\"report-btn\" onclick=\"tracker.reportMarker('${data.id}')\" ${\n      alreadyReported ? \"disabled\" : \"\"\n    }>\n      ${alreadyReported ? \"\u2713 Reported\" : \"\u26A0 Report\"}\n    </button>\n    <button id=\"upvote-btn\" onclick=\"tracker.upvoteMarker('${data.id}')\" ${\n      alreadyUpvoted ? \"disabled\" : \"\"\n    }>\n      \uD83D\uDC4D ${\n        alreadyUpvoted ? this.t(\"upvoted\") : this.t(\"upvote\")\n      } (<span id=\"upvote-count\">${data.upvotes || 0}</span>)\n    </button>\n  </div>\n\n  <div id=\"comments\"><h4>${this.t(\"comments\")}</h4></div>\n  <textarea id=\"newComment\" placeholder=\"${this.t(\"add_comment\")}\"></textarea>\n  <input id=\"commentAuthor\" placeholder=\"${this.t(\"author\")}\">\n  <button onclick=\"tracker.addComment('${data.id}')\">${this.t(\n      \"add_comment\"\n    )}</button>\n  \n  ${\n    this.canEdit(data)\n      ? `\n    <div class=\"admin-actions\">\n      <button onclick=\"tracker.deleteMarker('${data.id}')\">${this.t(\n          \"delete\"\n        )}</button>\n    </div>\n  `\n      : \"\"\n  }\n`;\n    this.loadComments(data.id);\n    document.getElementById(\"modal\").style.display = \"block\";\n  }\n\n  async upvoteMarker(markerId) {\n    const upvoteBtn = document.getElementById(\"upvote-btn\");\n    if (!upvoteBtn || upvoteBtn.disabled) return;\n\n    try {\n      const response = await fetch(`/api/upvotes/${markerId}`, {\n        method: \"POST\",\n      });\n      if (!response.ok) {\n        const err = await response.json();\n        throw new Error(err.error || \"Upvote failed\");\n      }\n\n      const data = await response.json();\n      sessionStorage.setItem(`upvoted_${markerId}`, \"true\");\n\n      upvoteBtn.disabled = true;\n      upvoteBtn.innerHTML = `\uD83D\uDC4D ${this.t(\"upvoted\")} (<span id=\"upvote-count\">${\n        data.upvotes\n      }</span>)`;\n\n      this.showToast(\"Upvoted!\", \"success\");\n    } catch (error) {\n      console.error(\"Upvote error:\", error);\n      this.showToast(error.message, \"error\");\n    }\n  }\n\n  async reportMarker(markerId) {\n    if (\n      !confirm(\n        this.t(\"confirm_report\") || \"Are you sure you want to report this?\"\n      )\n    ) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/markers/${markerId}/report`, {\n        method: \"POST\",\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Report failed\");\n      }\n\n      sessionStorage.setItem(`reported_${markerId}`, \"true\");\n\n      const reportBtn = document.getElementById(\"report-btn\");\n      if (reportBtn) {\n        reportBtn.disabled = true;\n        reportBtn.textContent = \"\u2713 Reported\";\n      }\n\n      this.showToast(\"Report submitted. Thank you.\", \"success\");\n    } catch (error) {\n      console.error(\"Report error:\", error);\n      this.showToast(\"Failed to submit report\", \"error\");\n    }\n  }\n\n  connectWebSocket() {\n    try {\n      const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n      const wsUrl = `${protocol}//${window.location.host}/ws`;\n\n      this.ws = new WebSocket(wsUrl);\n\n      this.ws.onopen = () => {\n        console.log(\"WebSocket connected\");\n        this.reconnectAttempts = 0;\n        this.showToast(\"Connected to live updates\", \"success\");\n      };\n\n      this.ws.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n        this.handleWebSocketMessage(data);\n      };\n\n      this.ws.onerror = (error) => {\n        console.error(\"WebSocket error:\", error);\n      };\n\n      this.ws.onclose = () => {\n        console.log(\"WebSocket disconnected\");\n        this.reconnectWebSocket();\n      };\n    } catch (error) {\n      console.error(\"Failed to establish WebSocket:\", error);\n    }\n  }\n\n  reconnectWebSocket() {\n    if (this.reconnectAttempts < this.maxReconnectAttempts) {\n      const delay = Math.min(1000 * Math.pow(2, this.reconnectAttempts), 30000);\n      this.reconnectAttempts++;\n\n      console.log(\n        `Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts})`\n      );\n      setTimeout(() => this.connectWebSocket(), delay);\n    } else {\n      this.showToast(\n        \"Live updates disconnected. Refresh page to reconnect.\",\n        \"error\"\n      );\n    }\n  }\n\n  handleWebSocketMessage(data) {\n    console.log(\"WebSocket message:\", data);\n\n    switch (data.type) {\n      case \"welcome\":\n        console.log(`Connected. ${data.activeUsers} active users`);\n        this.updateActiveUsers(data.activeUsers);\n        break;\n\n      case \"marker_added\":\n        if (!this.displayedMarkerIds.has(data.marker.id)) {\n          this.addMarkerToMap(data.marker);\n          this.showToast(\"New report added\", \"info\");\n          this.triggerHaptic(20);\n        }\n        break;\n\n      case \"active_users\":\n        this.updateActiveUsers(data.count);\n        break;\n\n      default:\n        console.log(\"Unknown message type:\", data.type);\n    }\n  }\n\n  updateActiveUsers(count) {\n    let userIndicator = document.getElementById(\"active-users\");\n    if (!userIndicator) {\n      userIndicator = document.createElement(\"div\");\n      userIndicator.id = \"active-users\";\n      userIndicator.className = \"active-users-indicator\";\n      document.querySelector(\".secondary-controls\").appendChild(userIndicator);\n    }\n    userIndicator.textContent = `\uD83D\uDC65 ${count} online`;\n  }\n\n  sendUserLocation() {\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n      const center = this.map.getView().getCenter();\n      const lonLat = ol.proj.toLonLat(center);\n\n      this.ws.send(\n        JSON.stringify({\n          type: \"user_location\",\n          location: {\n            lat: lonLat[1],\n            lng: lonLat[0],\n          },\n        })\n      );\n    }\n  }\n\n  canEdit(marker) {\n    return (\n      marker.magicCode === this.magicCode ||\n      localStorage.getItem(`edit_${marker.id}`) === \"true\"\n    );\n  }\n\n  async addComment(markerId) {\n    const text = document.getElementById(\"newComment\").value;\n    const author = document.getElementById(\"commentAuthor\").value;\n\n    if (!text) return;\n\n    const comment = {\n      markerId,\n      text,\n      author: author || \"Anonymous\",\n    };\n\n    try {\n      const response = await fetch(\"/api/comments\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(comment),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to save comment\");\n      }\n\n      this.loadComments(markerId);\n      this.showToast(\"Comment added\");\n      document.getElementById(\"newComment\").value = \"\";\n      document.getElementById(\"commentAuthor\").value = \"\";\n    } catch (error) {\n      console.error(\"Comment error:\", error);\n      this.showToast(\"Failed to add comment\", \"error\");\n    }\n  }\n\n  async loadComments(markerId) {\n    try {\n      const response = await fetch(`/api/comments/${markerId}`);\n      const comments = await response.json();\n\n      document.getElementById(\"comments\").innerHTML = comments\n        .map(\n          (c) => `\n        <div class=\"comment\">\n          <div class=\"comment-author\">${c.author}</div>\n          <div class=\"comment-time\">${new Date(\n            c.timestamp\n          ).toLocaleString()}</div>\n          <p>${c.text}</p>\n        </div>\n      `\n        )\n        .join(\"\");\n    } catch (error) {\n      console.error(\"Failed to load comments:\", error);\n    }\n  }\n\n  toggleAddMode() {\n    this.addMode = !this.addMode;\n    const btn = document.getElementById(\"addBtn\");\n\n    if (this.addMode) {\n      btn.innerHTML = `<span class=\"btn-icon\">\u2715</span> Done`;\n      btn.style.background = \"linear-gradient(45deg, #95a5a6, #7f8c8d)\";\n      this.showToast(\n        this.t(\"add_marker_instruction\") || \"Click on the map to add a report\"\n      );\n    } else {\n      btn.innerHTML = `<span class=\"btn-icon\">+</span> ${this.t(\n        \"add_new_marker\"\n      )}`;\n      btn.style.background = \"linear-gradient(45deg, #ff6b6b, #ee5a52)\";\n    }\n\n    gsap.to(btn, { scale: 1.05, duration: 0.1, yoyo: true, repeat: 1 });\n  }\n\n  changeLang(lang) {\n    this.currentLang = lang;\n    // Don't reinitialize everything, just update UI text\n    this.updateUIText();\n  }\n\n  closeModal() {\n    document.getElementById(\"modal\").style.display = \"none\";\n  }\n\n  triggerHaptic(pattern = 20) {\n    if (\"vibrate\" in navigator) {\n      navigator.vibrate(pattern);\n    }\n  }\n\n  playSound(type) {\n    try {\n      const audioContext = new (window.AudioContext ||\n        window.webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n\n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n\n      if (type === \"success\") {\n        oscillator.frequency.value = 800;\n        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(\n          0.01,\n          audioContext.currentTime + 0.1\n        );\n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.1);\n      } else if (type === \"error\") {\n        oscillator.frequency.value = 300;\n        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(\n          0.01,\n          audioContext.currentTime + 0.2\n        );\n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.2);\n      }\n    } catch (error) {\n      console.log(\"Audio not supported\");\n    }\n  }\n\n  showToast(message, type = \"info\") {\n    const toastContainer = document.getElementById(\"toast-container\");\n    const toast = document.createElement(\"div\");\n    toast.className = `toast toast-${type}`;\n    toast.textContent = message;\n    toastContainer.appendChild(toast);\n\n    setTimeout(() => {\n      toast.style.opacity = \"1\";\n      toast.style.transform = \"translateX(0)\";\n    }, 10);\n\n    setTimeout(() => {\n      toast.style.opacity = \"0\";\n      toast.style.transform = \"translateX(100%)\";\n      setTimeout(() => toast.remove(), 500);\n    }, 3000);\n\n    if (type === \"success\") {\n      this.triggerHaptic(20);\n      this.playSound(\"success\");\n    } else if (type === \"error\") {\n      this.triggerHaptic([50, 50, 50]);\n      this.playSound(\"error\");\n    }\n  }\n\n  async deleteMarker(id) {\n    if (!confirm(this.t(\"confirm_delete\"))) return;\n\n    try {\n      const response = await fetch(`/api/markers/${id}`, { method: \"DELETE\" });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to delete marker\");\n      }\n\n      const feature = this.vectorSource\n        .getFeatures()\n        .find((f) => f.get(\"id\") === id);\n      if (feature) this.vectorSource.removeFeature(feature);\n\n      this.markers = this.markers.filter((m) => m.id !== id);\n      this.updateStats();\n      this.updateCharts();\n      this.showToast(\"Report deleted\");\n      this.closeModal();\n    } catch (error) {\n      console.error(\"Delete error:\", error);\n      this.showToast(\"Failed to delete report\", \"error\");\n    }\n  }\n\n  setupInstallPrompt() {\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      this.deferredPrompt = e;\n      this.showInstallButton();\n    });\n\n    window.addEventListener(\"appinstalled\", () => {\n      console.log(\"PWA installed\");\n      this.deferredPrompt = null;\n      this.hideInstallButton();\n      this.showToast(\"App installed! Open from your home screen.\", \"success\");\n    });\n  }\n\n  showInstallButton() {\n    const installBtn = document.createElement(\"button\");\n    installBtn.id = \"install-btn\";\n    installBtn.className = \"secondary-btn\";\n    installBtn.innerHTML = \"\uD83D\uDCF1 Install App\";\n    installBtn.addEventListener(\"click\", () => this.promptInstall());\n\n    document.querySelector(\".controls\").appendChild(installBtn);\n  }\n\n  hideInstallButton() {\n    const installBtn = document.getElementById(\"install-btn\");\n    if (installBtn) {\n      installBtn.remove();\n    }\n  }\n\n  async promptInstall() {\n    if (!this.deferredPrompt) return;\n\n    this.deferredPrompt.prompt();\n    const { outcome } = await this.deferredPrompt.userChoice;\n\n    console.log(`Install prompt outcome: ${outcome}`);\n    this.deferredPrompt = null;\n    this.hideInstallButton();\n  }\n\n  async searchLocation() {\n    const query = document.getElementById(\"searchInput\").value;\n    if (query.length < 3) {\n      document.getElementById(\"searchResults\").style.display = \"none\";\n      return;\n    }\n\n    const searchButton = document.getElementById(\"searchBtn\");\n    searchButton.disabled = true;\n    searchButton.textContent = \"...\";\n\n    try {\n      const response = await fetch(\n        `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query)}&format=json&limit=5`\n      );\n      if (!response.ok) throw new Error(\"Search failed\");\n      const results = await response.json();\n      this.displaySearchResults(results);\n    } catch (error) {\n      console.error(\"Search error:\", error);\n      this.showToast(\"Search failed\", \"error\");\n    } finally {\n      searchButton.disabled = false;\n      searchButton.textContent = \"Search\";\n    }\n  }\n\n  displaySearchResults(results) {\n    const resultsContainer = document.getElementById(\"searchResults\");\n    resultsContainer.innerHTML = \"\";\n\n    if (results.length === 0) {\n      resultsContainer.innerHTML = '<div class=\"search-result-item\">No results found.</div>';\n      resultsContainer.style.display = \"block\";\n      return;\n    }\n\n    results.forEach((result) => {\n      const item = document.createElement(\"div\");\n      item.className = \"search-result-item\";\n      item.textContent = result.display_name;\n      item.onclick = () => {\n        this.panToLocation([parseFloat(result.lon), parseFloat(result.lat)]);\n        document.getElementById(\"searchInput\").value = result.display_name;\n        resultsContainer.style.display = \"none\";\n      };\n      resultsContainer.appendChild(item);\n    });\n\n    resultsContainer.style.display = \"block\";\n  }\n\n  panToLocation(lonLat) {\n    if (!this.map) return;\n\n    this.map.getView().animate({\n      center: ol.proj.fromLonLat(lonLat),\n      zoom: 14,\n      duration: 1500,\n      easing: ol.easing.easeOut,\n    });\n  }\n}\n\nICEPIGTracker.prototype.showLoadingIndicator = function () {\n  const indicator = document.getElementById(\"loading-indicator\");\n  if (indicator) indicator.style.display = \"flex\";\n};\n\nICEPIGTracker.prototype.hideLoadingIndicator = function () {\n  const indicator = document.getElementById(\"loading-indicator\");\n  if (indicator) {\n    indicator.remove();\n  }\n};\n\nICEPIGTracker.prototype.updateUIText = function () {\n  document.querySelectorAll(\"[data-translate-key]\").forEach((el) => {\n    const key = el.dataset.translateKey;\n    const translation = this.t(key);\n\n    // Handle elements where the entire content is the translation\n    if (el.children.length === 0 || el.tagName === \"TITLE\") {\n      el.textContent = translation;\n      return;\n    }\n\n    // Handle buttons with icons or other complex elements\n    for (const node of el.childNodes) {\n      if (\n        node.nodeType === Node.TEXT_NODE &&\n        node.textContent.trim().length > 0\n      ) {\n        node.textContent = ` ${translation}`;\n        break;\n      }\n    }\n  });\n};\n\nICEPIGTracker.prototype.updateStats = function () {\n  const today = new Date().toDateString();\n\n  this.stats = {\n    total: this.markers.length,\n    ice: this.markers.filter((m) => m.type === \"ICE\").length,\n    pig: this.markers.filter((m) => m.type === \"PIG\").length,\n    today: this.markers.filter(\n      (m) => new Date(m.timestamp).toDateString() === today\n    ).length,\n  };\n\n  this.animateStats();\n};\n\nICEPIGTracker.prototype.animateStats = function () {\n  Object.keys(this.stats).forEach((key) => {\n    const element = document.querySelector(`#stat-${key} .stat-number`);\n    if (element) {\n      gsap.to(\n        { value: parseInt(element.textContent) || 0 },\n        {\n          value: this.stats[key],\n          duration: 1.5,\n          ease: \"power2.out\",\n          onUpdate: function () {\n            element.textContent = Math.round(this.targets()[0].value);\n          },\n        }\n      );\n    }\n  });\n};\n\nICEPIGTracker.prototype.updateCharts = function () {\n  this.processChartData();\n  if (typeof this.renderTimelineChart === \"function\") {\n    this.renderTimelineChart();\n    this.renderTypeChart();\n    this.renderHeatmap();\n  }\n};\n\nICEPIGTracker.prototype.processChartData = function () {\n  // Reset data\n  this.chartData.timeline = [];\n  this.chartData.types = { ice: 0, pig: 0 };\n  this.chartData.hourly.fill(0);\n  this.chartData.daily.fill(0);\n\n  // Process markers\n  const dailyCounts = {};\n\n  this.markers.forEach((marker) => {\n    const date = new Date(marker.timestamp);\n    const dateStr = date.toDateString();\n    const hour = date.getHours();\n    const day = date.getDay();\n\n    // Timeline data\n    if (!dailyCounts[dateStr]) {\n      dailyCounts[dateStr] = { date: dateStr, ice: 0, pig: 0 };\n    }\n    dailyCounts[dateStr][marker.type.toLowerCase()]++;\n\n    // Type counts\n    this.chartData.types[marker.type.toLowerCase()]++;\n\n    // Hourly distribution\n    this.chartData.hourly[hour]++;\n\n    // Daily distribution\n    this.chartData.daily[day]++;\n  });\n\n  this.chartData.timeline = Object.values(dailyCounts)\n    .sort((a, b) => new Date(a.date) - new Date(b.date))\n    .slice(-30); // Last 30 days\n};\n\n\n// The tracker is initialized in main.js.\n"],
  "mappings": "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",
  "names": ["categories", "ICEPIGTracker", "error", "response", "key", "kcCenter", "createLayerControl", "legendContainer", "categories", "category", "legendItem", "iconSvg", "label", "feature", "type", "color", "iconUnicode", "searchContainer", "searchResults", "evt", "coords", "f", "categoryOptions", "cat", "modal", "title", "desc", "files", "marker", "saveBtn", "originalText", "progressContainer", "progressBar", "successfulUploads", "failedUploads", "uploadPromises", "file", "index", "url", "result", "successMessage", "markerId", "data", "uploadResponse", "retries", "delay", "resolve", "lon", "lat", "pixel", "pulseEl", "markers", "newCount", "refreshBtn", "mediaHtml", "fileExtension", "upvoteKey", "reportKey", "alreadyUpvoted", "alreadyReported", "upvoteBtn", "err", "reportBtn", "wsUrl", "event", "count", "userIndicator", "center", "lonLat", "text", "author", "comment", "comments", "c", "btn", "lang", "pattern", "audioContext", "oscillator", "gainNode", "message", "toastContainer", "toast", "id", "m", "installBtn", "outcome", "query", "searchButton", "results", "resultsContainer", "item", "indicator", "el", "translation", "node", "today", "element", "dailyCounts", "date", "dateStr", "hour", "day", "a", "b"]
}
