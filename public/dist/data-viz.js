ICEPIGTracker.prototype.setupDataViz=function(){this.chartData={timeline:[],types:{ice:0,pig:0},hourly:new Array(24).fill(0),daily:new Array(7).fill(0)}};ICEPIGTracker.prototype.updateStats=function(){let e=new Date().toDateString();this.stats={total:this.markers.length,ice:this.markers.filter(t=>t.type==="ICE").length,pig:this.markers.filter(t=>t.type==="PIG").length,today:this.markers.filter(t=>new Date(t.timestamp).toDateString()===e).length},this.animateStats()};ICEPIGTracker.prototype.animateStats=function(){Object.keys(this.stats).forEach(e=>{let t=document.querySelector(`#stat-${e} .stat-number`);t&&gsap.to({value:0},{value:this.stats[e],duration:1.5,ease:"power2.out",onUpdate:function(){t.textContent=Math.round(this.targets()[0].value)}})})};ICEPIGTracker.prototype.updateCharts=function(){this.processChartData(),this.renderTimelineChart(),this.renderTypeChart(),this.renderHeatmap()};ICEPIGTracker.prototype.processChartData=function(){this.chartData.timeline=[],this.chartData.types={ice:0,pig:0},this.chartData.hourly.fill(0),this.chartData.daily.fill(0);let e={};this.markers.forEach(t=>{let o=new Date(t.timestamp),a=o.toDateString(),p=o.getHours(),l=o.getDay();e[a]||(e[a]={date:a,ice:0,pig:0}),e[a][t.type.toLowerCase()]++,this.chartData.types[t.type.toLowerCase()]++,this.chartData.hourly[p]++,this.chartData.daily[l]++}),this.chartData.timeline=Object.values(e).sort((t,o)=>new Date(t.date)-new Date(o.date)).slice(-30)};ICEPIGTracker.prototype.renderTimelineChart=function(){let e=d3.select("#timeline-chart");if(e.selectAll("*").remove(),this.chartData.timeline.length===0)return;let t={top:20,right:30,bottom:40,left:40},o=360-t.left-t.right,a=200-t.top-t.bottom,l=e.append("svg").attr("width",o+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`);e.insert("h4","svg").text("Reports Over Time (Last 30 Days)").style("margin","0 0 15px 0").style("color","#2c3e50");let d=d3.scaleBand().domain(this.chartData.timeline.map(r=>r.date)).range([0,o]).padding(.1),c=d3.scaleLinear().domain([0,d3.max(this.chartData.timeline,r=>r.ice+r.pig)]).range([a,0]),n=d3.stack().keys(["ice","pig"])(this.chartData.timeline),s={ice:"#ff4444",pig:"#4444ff"};l.selectAll(".layer").data(n).enter().append("g").attr("class","layer").attr("fill",r=>s[r.key]).selectAll("rect").data(r=>r).enter().append("rect").attr("x",r=>d(r.data.date)).attr("y",a).attr("height",0).attr("width",d.bandwidth()).transition().duration(800).delay((r,h)=>h*50).attr("y",r=>c(r[1])).attr("height",r=>c(r[0])-c(r[1])),l.append("g").attr("transform",`translate(0,${a})`).call(d3.axisBottom(d).tickFormat("")),l.append("g").call(d3.axisLeft(c).ticks(5))};ICEPIGTracker.prototype.renderTypeChart=function(){let e=d3.select("#type-chart");e.selectAll("*").remove();let t=[{type:"ICE",count:this.chartData.types.ice,color:"#ff4444"},{type:"PIG",count:this.chartData.types.pig,color:"#4444ff"}];if(t.every(s=>s.count===0))return;e.append("h4").text("Report Types Distribution").style("margin","0 0 15px 0").style("color","#2c3e50");let o=360,a=200,p=Math.min(o,a)/2-20,d=e.append("svg").attr("width",o).attr("height",a).append("g").attr("transform",`translate(${o/2},${a/2})`),c=d3.pie().value(s=>s.count).sort(null),i=d3.arc().innerRadius(p*.4).outerRadius(p),n=d.selectAll(".arc").data(c(t)).enter().append("g").attr("class","arc");n.append("path").attr("fill",s=>s.data.color).attr("stroke","white").attr("stroke-width",2).transition().duration(800).attrTween("d",function(s){let r=d3.interpolate({startAngle:0,endAngle:0},s);return function(h){return i(r(h))}}),n.append("text").attr("transform",s=>`translate(${i.centroid(s)})`).attr("text-anchor","middle").attr("font-size","14px").attr("font-weight","bold").attr("fill","white").text(s=>s.data.count>0?s.data.count:"").style("opacity",0).transition().delay(800).duration(300).style("opacity",1)};ICEPIGTracker.prototype.renderHeatmap=function(){let e=d3.select("#heatmap-chart");e.selectAll("*").remove(),e.append("h4").text("Activity by Hour of Day").style("margin","0 0 15px 0").style("color","#2c3e50");let t=360,o=60,a=t/24,p=e.append("svg").attr("width",t).attr("height",o+40),l=d3.max(this.chartData.hourly),d=d3.scaleSequential(d3.interpolateBlues).domain([0,l||1]),c=p.selectAll(".hour-cell").data(this.chartData.hourly).enter().append("g").attr("class","hour-cell");c.append("rect").attr("x",(i,n)=>n*a).attr("y",20).attr("width",a-1).attr("height",o-20).attr("fill","#f0f0f0").transition().duration(600).delay((i,n)=>n*25).attr("fill",i=>d(i)),c.append("text").attr("x",(i,n)=>n*a+a/2).attr("y",15).attr("text-anchor","middle").attr("font-size","10px").attr("fill","#666").text((i,n)=>n%4===0?n:""),c.append("title").text((i,n)=>`${n}:00 - ${i} reports`)};ICEPIGTracker.prototype.toggleSidebar=function(){let e=document.getElementById("sidebar");e.classList.contains("open")?this.closeSidebar():(e.style.display="block",e.classList.add("open"),gsap.from("#chart-container > *",{x:50,opacity:0,duration:.5,stagger:.1,delay:.2}),this.updateCharts())};ICEPIGTracker.prototype.closeSidebar=function(){let e=document.getElementById("sidebar");e.classList.remove("open"),setTimeout(()=>{e.classList.contains("open")||(e.style.display="none")},400)};ICEPIGTracker.prototype.animateEntrance=function(){gsap.from("#header",{y:-100,opacity:0,duration:.8,ease:"power2.out"}),gsap.from(".stat-item",{y:50,opacity:0,duration:.6,stagger:.1,delay:.3,ease:"back.out(1.7)"}),gsap.from("#map-container",{scale:.9,opacity:0,duration:1,delay:.5,ease:"power2.out"}),gsap.from(".legend",{x:100,opacity:0,duration:.6,delay:.8})};ICEPIGTracker.prototype.showToast=function(e,t="success"){let o=document.getElementById("toast-container"),a=document.createElement("div");a.className="toast",a.textContent=e,t==="error"&&(a.style.borderLeftColor="#ff4444"),o.appendChild(a),gsap.from(a,{x:100,opacity:0,duration:.3}),setTimeout(()=>{gsap.to(a,{x:100,opacity:0,duration:.3,onComplete:()=>a.remove()})},6e3)};window.tracker=new ICEPIGTracker;window.tracker.init();
//# sourceMappingURL=data-viz.js.map
